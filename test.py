import streamlit as st

# ----------------------------
# 기본 설정
# ----------------------------
st.set_page_config(page_title="보건의료 웹앱", page_icon="🧑‍⚕️", layout="wide")
st.title("🧑‍⚕️ 전문 보건의료 웹앱")
st.write("""
⚠️ 본 앱은 의료 전문가의 진료를 대체하지 않습니다.  
정확한 진단이나 처치가 필요할 경우 반드시 병원 방문을 권장합니다.
""")

# ----------------------------
# 메뉴 선택
# ----------------------------
menu = st.sidebar.radio("메뉴 선택", ["홈", "자가진단", "운동 가이드", "약품 정보", "응급처치"])

# ----------------------------
# 홈
# ----------------------------
if menu == "홈":
    st.subheader("🏠 홈")
    st.write("""
본 앱은 자가 증상 확인, 재활 운동, 약품 정보, 응급처치 안내 등
건강 관리 보조 기능을 제공합니다.  
사용자의 안전과 정확한 진료를 위해 전문가 상담이 필수입니다.
""")

# ----------------------------
# 공통 데이터
# ----------------------------

# 증상 상세 정보
symptom_detail = {
    "두통": """
- 원인: 긴장성 두통, 편두통, 스트레스, 수면 부족, 카페인 과다, 시력 문제
- 동반 증상: 목/어깨 근육 긴장, 눈 피로, 메스꺼움, 빛과 소리에 민감
- 조치: 충분한 수분 섭취, 휴식, 온찜질, 진통제 복용 가능
- 주의: 갑작스럽거나 심한 두통, 시야 변화, 구토 동반 시 즉시 진료
""",
    "기침": """
- 원인: 감기, 기관지염, 폐렴, 알레르기, 천식
- 동반 증상: 가래, 발열, 목 통증, 호흡곤란
- 조치: 충분한 수분 섭취, 가습, 기침 완화제 복용, 휴식
- 주의: 2주 이상 지속, 피 섞인 가래, 호흡 곤란 시 진료 필요
""",
    "복통": """
- 원인: 소화불량, 위염, 장염, 과민성 장증후군, 식중독
- 동반 증상: 구역, 구토, 설사, 복부 팽만감, 발열
- 조치: 가벼운 식사, 수분 섭취, 소화제 복용 가능
- 주의: 극심 통증, 혈변, 지속적 구토, 고열 시 내과 진료
""",
    "발열": """
- 원인: 바이러스/세균 감염, 염증, 면역 반응
- 동반 증상: 오한, 근육통, 피로, 두통
- 조치: 충분한 휴식, 수분 섭취, 해열제 사용 가능
- 주의: 38℃ 이상 지속, 호흡 곤란, 의식 저하 시 즉시 진료
""",
    "피로감": """
- 원인: 과로, 수면 부족, 빈혈, 영양 부족, 스트레스
- 동반 증상: 무기력, 집중력 저하, 어지러움, 졸림
- 조치: 충분한 수면, 균형 잡힌 식사, 가벼운 운동
- 주의: 2주 이상 지속, 호흡 곤란, 빈혈 의심 시 전문 진료
""",
    "발목통증": """
- 원인: 발목 염좌, 근육/인대 손상, 반복적인 무리
- 동반 증상: 부종, 멍, 보행 시 통증, 관절 불안정
- 조치: RICE(휴식, 얼음찜질, 압박, 올리기), 보조기 착용
- 주의: 체중 부하 시 통증 심하면 정형외과 진료
""",
    "눈충혈": """
- 원인: 결막염, 알레르기, 안구 건조, 감염
- 동반 증상: 가려움, 눈물, 통증, 시야 흐림
- 조치: 인공눈물 사용, 눈 비비지 않기, 원인 회피
- 주의: 통증 심하거나 시력 저하 시 안과 진료
"""
}

# 증상별 추천 운동 (상세)
symptom_exercise = {
    "두통": """
- 목 스트레칭: 천천히 목을 좌우로 돌리며 10회 반복
- 어깨/목 근육 이완: 어깨를 올렸다 내리기 10회, 목 근육 마사지
- 가벼운 산책: 5~10분, 긴장 완화
- 눈 깜박임 운동: 화면 집중 후 20초마다 10번 깜박이기
- 심호흡 운동: 깊게 숨 들이마시고 내쉬기 5회
""",
    "기침": """
- 심호흡 운동: 코로 깊게 들이마시고 입으로 내쉬기 10회
- 전신 스트레칭: 팔, 다리, 몸통 스트레칭 5~10분
- 목 근육 풀기: 좌우 돌리기 10회, 어깨 회전 10회
""",
    "복통": """
- 복부 마사지: 시계 방향 2~3분
- 복부 스트레칭: 무릎 구부리고 눕기, 골반 기울이기
- 요가 자세: 고양이-소 자세, 아기 자세 5분
- 가벼운 걷기: 5~10분
""",
    "발열": """
- 휴식 중심: 충분한 수면과 안정
- 가벼운 스트레칭: 침대에서 팔, 다리 가볍게 움직이기
- 체온 조절: 과열 시 수건으로 시원하게
""",
    "피로감": """
- 전신 스트레칭: 팔, 다리, 몸통 5~10분
- 걷기: 가벼운 산책 10~15분
- 목/어깨 근육 풀기: 어깨 돌리기, 목 좌우 돌리기 10회
- 심호흡 운동: 5회, 깊게 들이마시고 내쉬기
""",
    "발목통증": """
- 발목 돌리기: 시계/반시계 10회
- 발목 밴드 운동: 저항 밴드 외번/내번 10회
- 균형 잡기 운동: 한 발로 서기 30초, 양쪽 반복
- 보조기 착용: 걷기 시 안정성 확보
""",
    "눈충혈": """
- 눈 깜박임 운동: 20초마다 10번
- 시선 좌우/상하 이동: 10회씩
- 눈 근육 스트레칭: 손바닥 온찜질 30초
- 휴식: 20-20-20 규칙 (20분마다 20초, 20피트 떨어진 곳 보기)
"""
}

# 증상별 추천 약품 (상세)
symptom_drug = {
    "두통": ["타이레놀", "이부프로펜", "아세트아미노펜", "진통제"],
    "기침": ["진해거담제", "항히스타민제", "기침완화 시럽", "기관지 확장제"],
    "복통": ["판토덱스", "소염제", "진통제", "소화제", "제산제"],
    "발열": ["타이레놀", "해열제", "이부프로펜"],
    "피로감": ["비타민제", "진정제", "철분제"],
    "발목통증": ["이부프로펜", "소염제", "진통제", "근육 이완제"],
    "눈충혈": ["항히스타민제", "인공눈물", "점안제"]
}

drug_info = {
    "타이레놀": {
        "효능": "경증~중등도 통증 완화(두통, 근육통, 치통), 해열 작용. 간에 부담 적어 임신 중 사용 가능.",
        "부작용": "과다 복용 시 간 손상, 드물게 알레르기 반응 발생 가능."
    },
    "이부프로펜": {
        "효능": "진통 및 염증 완화. 두통, 치통, 근육통, 관절염에 효과적.",
        "부작용": "위장 장애(속쓰림, 구토), 어지러움, 장기 사용 시 신장 기능 저하 가능."
    },
    "아세트아미노펜": {
        "효능": "타이레놀과 유사, 통증 완화 및 해열에 효과.",
        "부작용": "과량 복용 시 간 손상, 장기 복용 시 간 기능 주기적 확인 필요."
    },
    "진통제": {
        "효능": "일반 통증 완화용, 두통/근육통/생리통 등에 사용.",
        "부작용": "위장 장애, 어지러움, 드물게 알레르기 반응."
    },
    "진해거담제": {
        "효능": "기침 억제 및 가래 배출 도움.",
        "부작용": "졸림, 어지러움, 장기간 사용 시 소화 불량 가능."
    },
    "항히스타민제": {
        "효능": "알레르기 증상 완화(재채기, 콧물, 눈 가려움).",
        "부작용": "졸림, 구강 건조, 드물게 두통이나 심계항진."
    },
    "기침완화 시럽": {
        "효능": "마른 기침 억제, 목 통증 완화.",
        "부작용": "졸림, 드물게 위장 장애."
    },
    "기관지 확장제": {
        "효능": "천식 및 기관지 수축 완화, 호흡 개선.",
        "부작용": "심계항진, 떨림, 불면, 드물게 흉통."
    },
    "판토덱스": {
        "효능": "위산 억제, 소화불량 완화, 위염 치료에 도움.",
        "부작용": "두통, 복통, 드물게 설사 및 발진."
    },
    "소염제": {
        "효능": "염증 완화, 통증 완화, 근육통/관절염에 사용.",
        "부작용": "위장 장애, 드물게 피부 발진, 장기 복용 시 신장 부담."
    },
    "소화제": {
        "효능": "소화 기능 개선, 식후 더부룩함 완화.",
        "부작용": "복부 팽만감, 드물게 설사/변비."
    },
    "제산제": {
        "효능": "위산 중화, 속쓰림 완화.",
        "부작용": "변비, 설사, 드물게 복부 불편감."
    },
    "해열제": {
        "효능": "발열 감소, 두통/근육통 동반 시 완화.",
        "부작용": "위장 장애, 드물게 두통이나 간 부담."
    },
    "비타민제": {
        "효능": "영양 보충, 피로 회복, 면역 기능 보조.",
        "부작용": "과다 섭취 시 위장 장애, 설사."
    },
    "진정제": {
        "효능": "스트레스 완화, 긴장 완화, 수면 개선 도움.",
        "부작용": "졸림, 어지러움, 장기 복용 시 습관성 가능."
    },
    "철분제": {
        "효능": "빈혈 예방 및 개선, 피로 감소.",
        "부작용": "변비, 속쓰림, 드물게 구토."
    },
    "근육 이완제": {
        "효능": "근육 경직 완화, 통증 완화, 운동 후 회복 도움.",
        "부작용": "졸림, 어지러움, 드물게 위장 장애."
    },
    "인공눈물": {
        "효능": "눈 건조 완화, 눈 피로 감소, 콘택트렌즈 사용 시 도움.",
        "부작용": "일시적 눈 따가움, 드물게 알레르기 반응."
    },
    "점안제": {
        "효능": "알레르기 증상 완화, 충혈 감소.",
        "부작용": "일시적 시야 흐림, 드물게 눈 따가움."
    }
}

# ----------------------------
# 자가진단
# ----------------------------
if menu == "자가진단":
    st.subheader("🤒 자가진단 도구")
    st.write("현재 겪고 있는 증상을 선택하세요:")

    symptom = st.selectbox("증상 선택", ["선택 안 함", "두통", "기침", "복통", "발열", "피로감", "발목통증", "눈충혈"])

    if symptom != "선택 안 함":
        st.write(f"선택한 증상: **{symptom}**")

        # 아코디언으로 증상 상세
        with st.expander("증상 상세 정보"):
            st.info(symptom_detail[symptom])

        # 아코디언으로 추천 운동
        with st.expander("추천 운동"):
            st.text(symptom_exercise[symptom])

        # 아코디언으로 추천 약품
        with st.expander("추천 약품"):
            cols = st.columns(3)
            for i, drug in enumerate(symptom_drug.get(symptom, [])):
                if cols[i % 3].button(drug):
                    info = drug_info[drug]
                    st.success(f"💊 {drug} 정보")
                    st.write(f"**효능:** {info['효능']}")
                    st.write(f"**부작용:** {info['부작용']}")

# ----------------------------
# 운동 가이드
# ----------------------------
elif menu == "운동 가이드":
    st.subheader("🏋️ 운동 가이드")
    st.write("증상별 추천 운동 방법을 확인하세요:")
    for sym, exercise in symptom_exercise.items():
        with st.expander(f"{sym} 운동"):
            st.text(exercise)

# ----------------------------
# 약품 정보
# ----------------------------
elif menu == "약품 정보":
    st.subheader("💊 약품 정보")
    st.write("약 이름을 클릭하면 상세 정보 확인 가능:")
    all_drugs = set(sum(symptom_drug.values(), []))
    cols = st.columns(3)
    for i, drug in enumerate(all_drugs):
        if cols[i % 3].button(drug):
            info = drug_info[drug]
            st.success(f"💊 {drug} 정보")
            st.write(f"**효능:** {info['효능']}")
            st.write(f"**부작용:** {info['부작용']}")

# ----------------------------
# 응급처치
# ----------------------------
elif menu == "응급처치":
    st.subheader("🚨 응급처치 가이드")
    emergency_guide = {
        "심장마비 의심": """
1. 119에 신고
2. CPR(심폐소생술) 실시
3. 자동심장충격기(AED) 사용
4. 환자 안정, 필요 시 기도 확보
""",
        "호흡 곤란": """
1. 119 신고
2. 환자 편안한 자세 유지
3. 산소 공급 가능 시 사용
4. 심한 경우 기도 확보 및 응급처치
""",
        "출혈": """
1. 출혈 부위 압박
2. 깨끗한 거즈나 천으로 지혈
3. 필요 시 119 신고
4. 쇼크 증상 확인
""",
        "골절": """
1. 부목 고정
2. 출혈 및 상처 확인
3. 119 신고
4. 환자 이동 최소화
""",
        "화상": """
1. 찬물로 화상 부위 10~20분 냉각
2. 물집 터뜨리지 않기
3. 필요 시 소독 및 119 신고
"""
    }
    for k, v in emergency_guide.items():
        with st.expander(k):
            st.text(v)
